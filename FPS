-- [[ ·¥ò…™Íú±…™·¥õ Íú∞·¥òÍú±  ô·¥è·¥èÍú±·¥õ·¥á Ä - DRAG FIXED ]]
-- OWNER: ‡πÑ‡∏Å‡∏£‡∏™‡∏£ ‡∏û‡∏¥‡∏™‡∏¥‡∏©‡∏ê‡πå ü´°

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local Lighting = game:GetService("Lighting")
local Terrain = game:GetService("Workspace"):FindFirstChildOfClass("Terrain")
local LocalPlayer = Players.LocalPlayer

-- ‡∏•‡∏ö UI ‡πÄ‡∏Å‡πà‡∏≤‡∏ñ‡πâ‡∏≤‡∏°‡∏µ
if LocalPlayer.PlayerGui:FindFirstChild("PisitPotatoUI") then
    LocalPlayer.PlayerGui.PisitPotatoUI:Destroy()
end

local screenGui = Instance.new("ScreenGui", LocalPlayer.PlayerGui)
screenGui.Name = "PisitPotatoUI"
screenGui.ResetOnSpawn = false

-- ‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏´‡∏•‡∏±‡∏Å (Parent ‡∏Ç‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏õ‡∏∏‡πà‡∏°)
local MainFrame = Instance.new("Frame", screenGui)
MainFrame.Size = UDim2.new(0, 110, 0, 50)
MainFrame.Position = UDim2.new(0.8, 0, 0.5, 0)
MainFrame.BackgroundTransparency = 1
MainFrame.Active = true -- ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ö Input ‡πÑ‡∏î‡πâ

-- ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢ (FPS)
local mainBtn = Instance.new("TextButton", MainFrame)
mainBtn.Size = UDim2.new(0, 50, 0, 50)
mainBtn.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
mainBtn.Text = "FPS"
mainBtn.Font = "SourceSansBold"
mainBtn.TextSize = 16
mainBtn.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", mainBtn).CornerRadius = UDim.new(1, 0)
local stroke = Instance.new("UIStroke", mainBtn); stroke.Thickness = 2; stroke.Color = Color3.new(1,1,1)

-- ‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤ (OFF/ON)
local toggleBtn = Instance.new("TextButton", MainFrame)
toggleBtn.Size = UDim2.new(0, 50, 0, 30)
toggleBtn.Position = UDim2.new(0, 55, 0.5, -15)
toggleBtn.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
toggleBtn.Text = "OFF"
toggleBtn.Font = "SourceSansBold"
toggleBtn.TextSize = 14
toggleBtn.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", toggleBtn).CornerRadius = UDim.new(0, 8)

---------------------------------------------------------
-- [ ‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡∏≤‡∏Å‡πÉ‡∏´‡∏°‡πà (‡∏•‡∏∑‡πà‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏° ‡πÅ‡∏•‡∏∞‡∏Å‡∏î‡πÑ‡∏î‡πâ‡∏õ‡∏Å‡∏ï‡∏¥) ]
---------------------------------------------------------
local dragging, dragInput, dragStart, startPos

local function update(input)
    local delta = input.Position - dragStart
    MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏±‡∏Å‡∏à‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏•‡∏≤‡∏Å‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏∏‡∏Å‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°
local function setupDrag(obj)
    obj.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = MainFrame.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    obj.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)
end

setupDrag(mainBtn)
setupDrag(toggleBtn)

UserInputService.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        update(input)
    end
end)

---------------------------------------------------------
-- [ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏õ‡∏£‡∏±‡∏ö‡∏†‡∏≤‡∏û‡∏î‡∏¥‡∏ô‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô ]
---------------------------------------------------------
local isPotato = false

local function SetPotato(state)
    if state then
        toggleBtn.Text = "ON"
        toggleBtn.BackgroundColor3 = Color3.fromRGB(50, 200, 50)
        stroke.Color = Color3.fromRGB(50, 200, 50)
        
        -- ‡∏õ‡∏£‡∏±‡∏ö Material ‡∏ó‡∏±‡πâ‡∏á‡πÅ‡∏°‡∏û (‡∏î‡∏¥‡∏ô‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô)
        for _, v in pairs(game:GetDescendants()) do
            pcall(function()
                if v:IsA("Part") or v:IsA("UnionOperation") or v:IsA("MeshPart") then
                    v.Material = Enum.Material.SmoothPlastic
                    v.Reflectance = 0
                elseif v:IsA("Decal") or v:IsA("Texture") then
                    v.Transparency = 1
                elseif v:IsA("ParticleEmitter") or v:IsA("Trail") then
                    v.Enabled = false
                end
            end)
        end
        Lighting.GlobalShadows = false
        settings().Rendering.QualityLevel = 1
        if Terrain then Terrain.WaterWaveSize = 0; Terrain.WaterWaveSpeed = 0 end
    else
        toggleBtn.Text = "OFF"
        toggleBtn.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
        stroke.Color = Color3.new(1,1,1)
        -- ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡∏†‡∏≤‡∏û‡∏Å‡∏•‡∏±‡∏ö‡∏≠‡∏≤‡∏à‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏°‡∏≤‡∏Å ‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏´‡∏ç‡πà‡∏à‡∏∞‡πÄ‡∏ô‡πâ‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏¢‡∏≤‡∏ß‡πÄ‡∏•‡∏¢
    end
end

-- ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏•‡∏¥‡∏Å (‡πÅ‡∏¢‡∏Å‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏•‡∏≤‡∏Å)
mainBtn.MouseButton1Up:Connect(function()
    if not dragging then -- ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏ì‡∏∞‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏≤‡∏Å
        isPotato = not isPotato
        SetPotato(isPotato)
    end
end)

toggleBtn.MouseButton1Up:Connect(function()
    if not dragging then
        isPotato = not isPotato
        SetPotato(isPotato)
    end
end)
