-- [[ Mobile Draggable + Toggle Speed 100 Fixed ]]
local player = game.Players.LocalPlayer
local screenGui = Instance.new("ScreenGui", player.PlayerGui)
screenGui.Name = "Speed100FixedMenu"
screenGui.ResetOnSpawn = false

-- 1. สร้างปุ่มหลัก (Main Button)
local mainBtn = Instance.new("TextButton", screenGui)
mainBtn.Size = UDim2.new(0, 80, 0, 80)
mainBtn.Position = UDim2.new(0.1, 0, 0.5, 0)
mainBtn.BackgroundColor3 = Color3.fromRGB(200, 0, 0) -- เริ่มต้นสีแดง (OFF)
mainBtn.Text = "SPEED\nOFF"
mainBtn.TextColor3 = Color3.new(1, 1, 1)
mainBtn.Font = Enum.Font.SourceSansBold
mainBtn.TextSize = 18
Instance.new("UICorner", mainBtn).CornerRadius = UDim.new(1, 0)
local stroke = Instance.new("UIStroke", mainBtn)
stroke.Thickness = 3
stroke.Color = Color3.new(1, 1, 1)

-- [ ระบบลากปุ่ม ]
local dragging, dragInput, dragStart, startPos
mainBtn.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true; dragStart = input.Position; startPos = mainBtn.Position
    end
end)
game:GetService("UserInputService").InputChanged:Connect(function(input)
    if (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) and dragging then
        local delta = input.Position - dragStart
        mainBtn.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)
game:GetService("UserInputService").InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = false
    end
end)

-- [ ระบบเปิด-ปิด และล็อคค่า 100 ]
local speedActive = false

mainBtn.MouseButton1Click:Connect(function()
    if dragging then return end -- ป้องกันการกดโดนขณะลาก
    
    speedActive = not speedActive
    
    if speedActive then
        mainBtn.Text = "SPEED\nON"
        mainBtn.BackgroundColor3 = Color3.fromRGB(0, 200, 0) -- สีเขียว (ON)
    else
        mainBtn.Text = "SPEED\nOFF"
        mainBtn.BackgroundColor3 = Color3.fromRGB(200, 0, 0) -- สีแดง (OFF)
        -- คืนค่าปกติเมื่อปิด
        local char = player.Character
        local hum = char and char:FindFirstChildOfClass("Humanoid")
        if hum then hum.WalkSpeed = 16 end
    end
end)

-- ระบบ Loop บังคับความเร็ว 100 ตลอดเวลา (ถ้าเปิดใช้งาน)
task.spawn(function()
    while true do
        if speedActive then
            pcall(function()
                local char = player.Character
                local hum = char and char:FindFirstChildOfClass("Humanoid")
                if hum and hum.WalkSpeed ~= 100 then
                    hum.WalkSpeed = 100
                end
            end)
        end
        task.wait(0.1) -- เช็คถี่ๆ เพื่อไม่ให้ความเร็วตก
    end
end)
